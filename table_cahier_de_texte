-- Active: 1742934672239@@127.0.0.1@3306@cahier_de_texte
-- Création de la base de données
CREATE DATABASE IF NOT EXISTS cahier_de_texte;

USE cahier_de_texte;

-- Table UtilisateurstestDataBase
CREATE TABLE IF NOT EXISTS Utilisateurs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    prenom VARCHAR(50) NOT NULL,
    nom VARCHAR(30) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role ENUM('Chef', 'Enseignant', 'Responsable') NOT NULL,
    date_creation DATETIME DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO `Utilisateurs`(prenom , nom , email , password , role )
-- VALUES ("Aliou" , "CIISE" , "aliou@gmail.com" , "12345" , "Responsable")
-- VALUES ("Papisco" , "sene" , "papisco@gmail.com" , "12345" , "Enseignant");
VALUES ("papa" , "cisse" , "chef@gmail.com" , "12345" , "Chef");



CREATE TABLE IF NOT EXISTS Eleves (
    id INT AUTO_INCREMENT PRIMARY KEY,
    prenom VARCHAR(100) NOT NULL,
    nom VARCHAR(50) NOT NULL,
    classe_id INT NOT NULL,
    FOREIGN KEY (classe_id) REFERENCES Classes(id)
);


CREATE TABLE IF NOT EXISTS Absences (
    id INT AUTO_INCREMENT PRIMARY KEY,
    eleve_id INT NOT NULL,
    seance_id INT NOT NULL,
    date_absence DATE NOT NULL,
    raison VARCHAR(255),
    FOREIGN KEY (eleve_id) REFERENCES Eleves(id),
    FOREIGN KEY (seance_id) REFERENCES Seances(id)
);


-- Table Cours
CREATE TABLE IF NOT EXISTS Cours (
    id INT AUTO_INCREMENT PRIMARY KEY,
    code VARCHAR(20) UNIQUE NOT NULL,
    intitule VARCHAR(200) NOT NULL,
    credits INT NOT NULL,
    enseignant_id INT,
    FOREIGN KEY (enseignant_id) REFERENCES Utilisateurs(id)
);


-- Table Seances
CREATE TABLE IF NOT EXISTS Seances (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cours_id INT NOT NULL,
    date_seance DATETIME NOT NULL,
    contenu TEXT NOT NULL,
    duree INT NOT NULL,
    FOREIGN KEY (cours_id) REFERENCES Cours(id)
);

-- Table Validations
CREATE TABLE IF NOT EXISTS Validations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    responsable_id INT NOT NULL,
    seance_id INT NOT NULL,
    date_validation DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (responsable_id) REFERENCES Utilisateurs(id),
    FOREIGN KEY (seance_id) REFERENCES Seances(id)
);


-- Table Absences
CREATE TABLE IF NOT EXISTS Absences (
    id INT AUTO_INCREMENT PRIMARY KEY,
    prenom VARCHAR(100) NOT NULL,
    nom VARCHAR(50) NOT NULL,
    classe VARCHAR(50) NOT NULL,
    seance_id INT NOT NULL,
    date_absence DATE NOT NULL,
    raison VARCHAR(255),

    FOREIGN KEY (seance_id) REFERENCES Seances(id),
);


-- Table Classes
CREATE TABLE IF NOT EXISTS Classes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100) NOT NULL
    
);
